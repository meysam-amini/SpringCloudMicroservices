server.port=8082
spring.application.name=api-gateway
# the url by which the client apps communicate with Eureka server
eureka.client.service-url.defaultZone=http://localhost:8010/eureka

# to enable discovery locator feature, so our gateway will try to
# map requests to a service that is registered with Eureka and we
# dont need any configs for routing:
#####################################################
spring.cloud.gateway.discovery.locator.enabled=true
spring.cloud.gateway.discovery.locator.lower-case-service-id=true
#####################################################

spring.cloud.gateway.routes[0].id=users-status-check

# lb: load-balancer. In this way, API gateway will fetch service socket
# address from Eureka by service's registered name (MS app name: users-ws)
# and use built in load-balancer client and rout requests to one of the
# running instances of this MS
spring.cloud.gateway.routes[0].uri=lb://users-ws
#If the request URl path matches below, routing will work:
spring.cloud.gateway.routes[0].predicates[0]=Path=/users/status/check
# for checking the existance of jwt in header:
spring.cloud.gateway.routes[0].predicates[1]=Header=Authorization, Bearer (.*)
# Only if HTTP method was GET, routing will work:
 spring.cloud.gateway.routes[0].predicates[2]=Method=GET
# our MS doesn't need request cookies:
spring.cloud.gateway.routes[0].filters[0]=RemoveRequestHeader=Cookie
spring.cloud.gateway.routes[0].filters[1]=AuthorizationHeaderFilter

################## users-ws:
spring.cloud.gateway.routes[1].id=users-ws-get-update-delete
spring.cloud.gateway.routes[1].uri=lb://users-ws
spring.cloud.gateway.routes[1].predicates[0]=Path=/users/**
spring.cloud.gateway.routes[1].predicates[1]=Header=Authorization, Bearer (.*)
spring.cloud.gateway.routes[1].predicates[2]=Method=GET,PUT,DELETE,POST
spring.cloud.gateway.routes[1].filters[0]=RemoveRequestHeader=Cookie
#spring.cloud.gateway.routes[1].filters[1]=AuthorizationHeaderFilter
################## wallet-ws:
spring.cloud.gateway.routes[2].id=wallet-ws-get-update-delete
spring.cloud.gateway.routes[2].uri=lb://wallet-ws
spring.cloud.gateway.routes[2].predicates[0]=Path=/member-wallet/**
#spring.cloud.gateway.routes[1].predicates[1]=Header=Authorization, Bearer (.*)
spring.cloud.gateway.routes[2].predicates[1]=Method=GET,PUT,DELETE,POST
#spring.cloud.gateway.routes[1].filters[0]=RemoveRequestHeader=Cookie
#spring.cloud.gateway.routes[1].filters[1]=AuthorizationHeaderFilter

